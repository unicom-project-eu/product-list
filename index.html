<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>prodlist</title>
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="assets/fonts/font-awesome.min.css">
    <link rel="stylesheet" href="assets/css/styles.min.css">
</head>

<body>
    <nav class="navbar navbar-dark navbar-expand-md bg-dark py-3" style="width: 100%;">
        <div class="container"><a class="navbar-brand d-flex align-items-center" href="#"><span class="bs-icon-sm bs-icon-rounded bs-icon-primary d-flex justify-content-center align-items-center me-2 bs-icon" style="height: 47px;width: 47px;"><i class="fa fa-list-ul" style="font-size: 32px;"></i></span><span>Product Browser</span></a><button data-bs-toggle="collapse" class="navbar-toggler" data-bs-target="#navcol-5"><span class="visually-hidden">Toggle navigation</span><span class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse" id="navcol-5">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link active" href="#">MedicinalProducts</a></li>
                    <li class="nav-item"><a class="nav-link" href="#">Manage...</a></li>
                    <li class="nav-item"><a class="nav-link" href="#">Config</a></li>
                </ul><a class="btn btn-primary ms-md-2" role="button" href="#">Refresh</a>
            </div>
        </div>
    </nav>
    <header>
        <div>
            <p>&nbsp; &nbsp; &nbsp;&nbsp;</p>
        </div>
    </header>
    <div>
        <div>
            <div>
                <ul class="nav nav-tabs justify-content-end" role="tablist">
                    <li class="nav-item" role="presentation"><a class="nav-link active" href="#tab-1" role="tab" data-bs-toggle="tab">Product Browser</a></li>
                    <li class="nav-item" role="presentation"><a class="nav-link" href="#tab-2" role="tab" data-bs-toggle="tab">Content Management</a></li>
                    <li class="nav-item" role="presentation"><a class="nav-link" href="#tab-3" role="tab" data-bs-toggle="tab">Config</a></li>
                </ul>
            </div>
        </div>
        <div class="tab-content" style="background: var(--bs-white);">
            <div id="tab-1" class="tab-pane active" role="tabpanel">
                <p style="text-align: center;font-weight: bold;">Product Browser<br></p>
                <div class="table-responsive" style="padding: 38px;">
                    <table class="table display" id="prod-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Country</th>
                                <th>Viewer</th>
				<th>Source</th>
				<th>Validation</th>        
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div id="tab-2" class="tab-pane" role="tabpanel">
                <div>
                    <p style="font-weight: bold;text-align: center;">Content Management</p>
                    <div class="container">
                        <div class="row">
                            <div class="col-2">
                                <p style="text-align: right;font-weight: bold;">Upload transaction</p>
                            </div>
                            <div class="col-5"><input type="file"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="tab-3" class="tab-pane" role="tabpanel">
                <p>Content for tab 3.<br></p>
            </div>
        </div>
    </div>
    <ul id="container" class="list-group"></ul><script>

var baseurl=window.location.origin
    
    
var url=baseurl+'/fhir/ManufacturedItemDefinition?_format=json';

url=baseurl+'/fhir/MedicinalProductDefinition?_format=json';
    /*
fetch(url)
  .then(response => {
    if (response.ok) {
      return response.json();
    } else {
      throw new Error(response.statusText);
    }
  })
  .then(data => populate(data.entry));
    
function populate(list){
    const container = document.getElementById("container");
    console.log(list);
    for (prod in list) {
      console.log(prod);
      let li = document.createElement("li");
      let node = document.createTextNode(prod.fullUrl);
      li.appendChild(node);
      container.appendChild(li);
    }
}
    */
    fetch(url)
  .then((response) => response.json())
  .then((posts) => {
        for (prod in posts.entry) {
/*
          let li = document.createElement("li");
          let node = document.createTextNode(posts.entry[prod].resource.name[0].productName);
            
          li.classList.add('list-group-item')
          li.classList.add('list-group-item-action')
          li.appendChild(node);
          container.appendChild(li);
*/            

            /*
var tbodyRef = document.getElementById('prod-table').getElementsByTagName('tbody')[0];
var newRow = tbodyRef.insertRow();
var newCell = newRow.insertCell();
newCell.innerHTML=posts.entry[prod].resource.id;            
var newCell = newRow.insertCell();
newCell.innerHTML=posts.entry[prod].resource.name[0].productName;            
           */ 
           
            
var t = $('#prod-table').DataTable();   
   t.pageLength=2;         
   t.row.add( [
       posts.entry[prod].resource.id,
       '<b>'+posts.entry[prod].resource.name[0].productName,
       posts.entry[prod].resource.name[0].countryLanguage[0].country.coding[0].display,
       '<a target="_blank" href="https://idmp-viewer.azurewebsites.net/display-product?url='+baseurl+'/fhir/MedicinalProductDefinition/'+posts.entry[prod].resource.id+'">Viewer</a> <a target="_blank" href="http://185.11.167.107:8084/apps/visualiser/index.html?url='+baseurl+'/fhir/MedicinalProductDefinition/'+posts.entry[prod].resource.id+'">New Viewer</a>',
       '<a target="_blank" href="'+baseurl+'/fhir/MedicinalProductDefinition/'+posts.entry[prod].resource.id+'?_format=xml">XML</a> &nbsp;&nbsp;&nbsp; <a href="'+baseurl+'/fhir/MedicinalProductDefinition/'+posts.entry[prod].resource.id+'?_format=json">JSON</a>',
       '<a target="_blank" href="'+baseurl+'/fhir/MedicinalProductDefinition/'+posts.entry[prod].resource.id+'/$validate">FHIR Validation</a>'
        ] ).draw();
        }
       }
     )

    
</script><script src="/assets/js/jquery.min.js"></script>
<script>
    $(document).ready( function () {
      $('#prod-table').DataTable({
//          dom: 'lfrtip',
          dom: 'frtlip',
          pageLength: 100,
          lengthMenu: [0, 5, 10, 20, 50, 100, 200, 500],
          columns: [ { width: "15%" }, null, { width: "17%" }, { width: "7%" },{ width: "10%" } ]
          
      });
    } );
</script><script>
  document.querySelector('.custom-file-input').addEventListener('change', function (e) {
    var name = document.getElementById("customFileInput").files[0].name;
    var nextSibling = e.target.nextElementSibling
    nextSibling.innerText = name
  })
</script>
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/bootstrap/js/bootstrap.min.js"></script>
    <script src="assets/js/script.min.js"></script>
</body>

</html>
